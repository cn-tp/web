import{K as se,$ as pe,h as ce,o as ue,E as s,j as I,k as b,s as i,x as d,a5 as l,A as p,a6 as me,B as n,C as $,X as L,W as k,w as v,O as c,p as m,q as y,J as W,y as fe,z as ge,D as ve,n as _e,a1 as be}from"./vendor.8327e786.js";import{k as he,l as we,m as Ie,b as ye,n as Ce,o as Ve,p as De,q as Le,r as ke,s as Ne,t as xe}from"./index.9e1fbb07.js";import{_ as Te}from"./index.10c62aa1.js";const qe=D=>(fe("data-v-7a5b90b2"),D=D(),ge(),D),Me={class:"app-container"},Ae={id:"app",slot:"body"},Ue=m("\u641C\u7D22"),Se=m("\u65B0\u589E"),ze=m("\u8F68\u8FF9"),Fe={style:{"text-align":"right","margin-top":"15px"}},$e={class:"drawer__content"},We=["item"],Be={class:"buttonclass"},Ke={class:"buttonclass"},Ee=m("\u4E0A \u4F20"),Oe=m("\u4FDD\u5B58\u914D\u7F6E\u4FE1\u606F"),Pe={key:0},je={slot:"footer",class:"dialog-footer"},Je=m("\u53D6 \u6D88"),Re=m("\u786E \u5B9A"),He=qe(()=>b("div",{height:"50%"},null,-1)),Xe={slot:"footer",class:"dialog-footer"},Ge=m("\u5173\u95ED"),Qe={setup(D){const{proxy:C}=ve();se();const M=pe(),e=ce({selectedDdeviceId:2,deviceTrackVisible:!1,tableData:{pagination:{pageNum:1,pageSize:10,totalPage:0},rows:[]},queryDatas:{deviceName:"",deviceCode:"",appId:"",deviceCategoryId:""},drawer:!1,drawerLoading:!1,form:{deviceId:null,deviceName:"",deviceCode:"",appId:"",ctime:"",deviceCategoryId:""},formLabelWidth:"150px",drawerType:1,categories:[],configList:[],configModels:[],activeTab:"first",advancedForm:{templateId:[]},templateList:[],templates:[],uploadDialog:!1,applications:[]});ue(()=>{J(),Q(),V(),ee()});function B(a){e.tableData.pagination.pageSize=a,V()}function K(a){e.tableData.pagination.pageNum=a,V()}function N(){e.tableData.pagination.pageNum=1,V()}function V(){he({deviceName:e.queryDatas.deviceName,deviceCode:e.queryDatas.deviceCode,appId:e.queryDatas.appId,deviceCategoryId:e.queryDatas.deviceCategoryId,pageNum:e.tableData.pagination.pageNum,pageSize:e.tableData.pagination.pageSize}).then(a=>{a&&a.code===200?(e.tableData.rows=a.items,e.tableData.pagination.totalPage=a.totalPage):s.error(a.code+": "+a.message)}).catch(a=>{console.log(a)})}function E(){e.drawerType=1,e.drawer=!0}function A(a){Ce({id:a}).then(t=>{t&&t.code===200?(e.drawerType=2,e.drawer=!0,_e(()=>{e.form.deviceId=t.deviceId,e.form.deviceName=t.deviceName,e.form.deviceCode=t.deviceCode,e.form.appId=t.appId,e.form.ctime=t.ctime,e.form.deviceCategoryId=t.deviceCategoryId,R()})):s.error(t.code+": "+t.message)}).catch(t=>{console.log(t)})}function x(a){e.drawerLoading||(C.$refs.form!==void 0&&C.$refs.form.resetFields(),C.$refs.advancedForm!==void 0&&C.$refs.advancedForm.resetFields(),e.drawerLoading=!1,e.configList=[],e.configModels=[],e.activeTab="first",e.drawer=!1,V())}function O(){C.$refs.form.validate(a=>{if(a)be.confirm("\u786E\u5B9A\u8981\u63D0\u4EA4\u8868\u5355\u5417\uFF1F").then(t=>{e.drawerLoading=!0,e.drawerType==1?P():e.drawerType==2&&j(),e.drawerLoading=!1});else{console.log("error submit!!");return}})}function P(){Ve({deviceName:e.form.deviceName,deviceCode:e.form.deviceCode,appId:e.form.appId,deviceCategoryId:e.form.deviceCategoryId}).then(a=>{a&&a.code===200?(s.success("success"),e.drawerLoading=!1,x()):s.error(a.code+": "+a.message)})}function j(){De({id:e.form.deviceId,deviceName:e.form.deviceName,deviceCode:e.form.deviceCode,appId:e.form.appId,deviceCategoryId:e.form.deviceCategoryId}).then(a=>{a&&a.code===200?(s.success("success"),x()):s.error(a.code+": "+a.message)}).catch(a=>{s.error("error"),e.drawerLoading=!1})}function J(){we({status:20}).then(a=>{if(a&&a.code==200){e.categories=[];for(var t=0;t<a.items.length;t++)e.categories.push(a.items[t])}else s.error(a.code+": "+a.message)})}function R(){e.configList=[],e.configModels=[],Le({deviceId:e.form.deviceId}).then(a=>{a&&a.code==200?(a.items&&a.items.length>0&&(e.configList=a.items),setTimeout(H,100)):s.error(a.code+": "+a.message)})}function H(){ke({configId:e.form.deviceCategoryId}).then(a=>{if(a&&a.code==200){e.configModels=[];for(var t=0;t<a.items.length;t++){var r=a.items[t];r.configModelValue=X(a.items[t].id),e.configModels.push(r)}}else s.error(a.code+": "+a.message)}).catch(a=>{console.log(a)})}function X(a){for(var t=0;t<e.configList.length;t++)if(a==e.configList[t].configModelId)return e.configList[t].configModelValue||"";return""}function G(){C.$refs.advancedForm.validate(a=>{a&&Ne({deviceId:e.form.deviceId,configs:e.configModels}).then(t=>{t&&t.code==200?s.success("\u4FDD\u5B58\u8BBE\u5907\u5C5E\u6027\u6210\u529F"):s.error(t.code+": "+t.message)}).catch(t=>{console.log(t)})})}function Q(){Ie({}).then(a=>{if(a&&a.code===200){if(a.items&&a.items.length>0){e.templateList=[];for(var t=0;t<a.items.length;t++)e.templateList.push(a.items[t]);Y()}}else s.error(a.code+": "+a.message)}).catch(a=>{console.log(a)})}function Y(){e.templates=[];for(var a=0;a<e.templateList.length;a++){var t={label:e.templateList[a].commandDesc,value:0,children:[]};JSON.stringify(e.templates).indexOf(JSON.stringify(t))===-1&&e.templates.push(t)}for(var r=0;r<e.templateList.length;r++)for(var f=0;f<e.templates.length;f++){e.templateList[r].commandDesc===e.templates[f].label&&e.templates[f].children.push({label:e.templateList[r].subCommandDesc,value:e.templateList[r].id});break}}function Z(){e.uploadDialog=!1,xe({deviceId:e.form.deviceId,templateId:e.advancedForm.templateId[1],appId:e.form.appId}).then(a=>{e.advancedForm.templateId=[],a&&a.code==200?s.success("\u4E0A\u4F20\u6210\u529F"):s.error(a.code+": "+a.message)}).catch(a=>{})}function ee(){ye({orgId:parseInt(window.localStorage.getItem("oid")||""),pageNum:1,pageSize:1e3}).then(a=>{a&&a.code===200?e.applications=a.items||[]:s.error(a.code+": "+a.message)}).catch(a=>{})}function ae(a){for(var t=0;t<e.applications.length;t++)if(a==e.applications[t].appId)return e.applications[t].name;return""}function te(){return"padding:3px;"}function oe(){return"padding:3px;"}return(a,t)=>{const r=p("el-input"),f=p("el-col"),T=p("el-option"),q=p("el-select"),u=p("el-button"),U=p("el-row"),h=p("el-table-column"),le=p("el-table"),de=p("el-pagination"),w=p("el-form-item"),S=p("el-form"),z=p("el-tab-pane"),ie=p("el-tabs"),ne=p("el-drawer"),re=p("el-cascader"),F=p("el-dialog"),g=me("waves");return n(),I("div",Me,[b("div",Ae,[i(U,{gutter:20},{default:d(()=>[i(f,{span:4},{default:d(()=>[i(r,{modelValue:l(e).queryDatas.deviceName,"onUpdate:modelValue":t[0]||(t[0]=o=>l(e).queryDatas.deviceName=o),modelModifiers:{trim:!0},placeholder:"\u8BBE\u5907\u540D\u79F0",class:"filter-item",clearable:"",onKeyup:$(N,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),i(f,{span:4},{default:d(()=>[i(r,{modelValue:l(e).queryDatas.deviceCode,"onUpdate:modelValue":t[1]||(t[1]=o=>l(e).queryDatas.deviceCode=o),modelModifiers:{trim:!0},placeholder:"\u8BBE\u5907\u7F16\u53F7",class:"filter-item",clearable:"",onKeyup:$(N,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),i(f,{span:4},{default:d(()=>[i(r,{modelValue:l(e).queryDatas.appId,"onUpdate:modelValue":t[2]||(t[2]=o=>l(e).queryDatas.appId=o),modelModifiers:{trim:!0},placeholder:"AppId",class:"filter-item",clearable:""},null,8,["modelValue"])]),_:1}),i(f,{span:4},{default:d(()=>[i(q,{modelValue:l(e).queryDatas.deviceCategoryId,"onUpdate:modelValue":t[3]||(t[3]=o=>l(e).queryDatas.deviceCategoryId=o),clearable:"",placeholder:"\u8BBE\u5907\u7C7B\u578B"},{default:d(()=>[(n(!0),I(L,null,k(l(e).categories,o=>(n(),c(T,{key:o.id,label:o.description,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(f,{span:4},{default:d(()=>[v((n(),c(u,{class:"filter-item",plain:"",icon:"el-icon-search",onClick:N},{default:d(()=>[Ue]),_:1})),[[g]])]),_:1})]),_:1}),i(U,{type:"flex",justify:"end"},{default:d(()=>[i(f,{span:4,style:{"text-align":"right","margin-top":"15px"}},{default:d(()=>[v((n(),c(u,{class:"filter-item",style:{"margin-left":"10px"},plain:"",icon:"el-icon-plus",onClick:E},{default:d(()=>[Se]),_:1})),[[g]])]),_:1})]),_:1}),i(le,{data:l(e).tableData.rows,style:{width:"100%"},"cell-style":te,"header-cell-style":oe},{default:d(()=>[i(h,{prop:"deviceId",label:"#",width:"80","show-overflow-tooltip":""}),i(h,{prop:"deviceName",label:"\u8BBE\u5907\u540D\u79F0","show-overflow-tooltip":""},{default:d(o=>[v((n(),c(u,{type:"text",onClick:_=>A(o.row.deviceId)},{default:d(()=>[m(y(o.row.deviceName),1)]),_:2},1032,["onClick"])),[[g]])]),_:1}),i(h,{prop:"deviceCode",label:"\u8BBE\u5907\u7F16\u53F7","show-overflow-tooltip":""},{default:d(o=>[v((n(),c(u,{type:"text",onClick:_=>A(o.row.deviceId)},{default:d(()=>[m(y(o.row.deviceCode),1)]),_:2},1032,["onClick"])),[[g]])]),_:1}),i(h,{prop:"appId",label:"\u5E94\u7528\u540D\u79F0","show-overflow-tooltip":""},{default:d(o=>[v((n(),c(u,{type:"text",onClick:_=>l(M).push({path:"/app",query:{appId:o.row.appId}})},{default:d(()=>[m(y(ae(o.row.appId)),1)]),_:2},1032,["onClick"])),[[g]])]),_:1}),i(h,{prop:"appId",label:"appId","show-overflow-tooltip":""},{default:d(o=>[v((n(),c(u,{type:"text",onClick:_=>l(M).push({path:"/app",query:{appId:o.row.appId}})},{default:d(()=>[m(y(o.row.appId),1)]),_:2},1032,["onClick"])),[[g]])]),_:1}),i(h,{label:"\u8BBE\u5907\u8F68\u8FF9","show-overflow-tooltip":""},{default:d(o=>[v((n(),c(u,{type:"text",onClick:_=>(l(e).deviceTrackVisible=!0,l(e).selectedDdeviceId=o.row.deviceId)},{default:d(()=>[ze]),_:2},1032,["onClick"])),[[g]])]),_:1}),i(h,{prop:"deviceCategoryDescription",label:"\u8BBE\u5907\u7C7B\u578B","show-overflow-tooltip":""}),i(h,{prop:"ctime",label:"\u521B\u5EFA\u65F6\u95F4","show-overflow-tooltip":""})]),_:1},8,["data"]),b("div",Fe,[i(de,{"current-page":l(e).tableData.pagination.pageNum,"pager-count":5,"page-sizes":[10,20,50,100],"page-size":l(e).tableData.pagination.pageSize,"page-count":l(e).tableData.pagination.totalPage,background:"",layout:"sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:K},null,8,["current-page","page-size","page-count"])]),i(ne,{ref:"drawer",title:"\u8BBE\u5907\u4FE1\u606F / "+(l(e).drawerType==1?"\u65B0\u589E":l(e).form.deviceName),"before-close":x,modelValue:l(e).drawer,"onUpdate:modelValue":t[11]||(t[11]=o=>l(e).drawer=o),"destroy-on-close":!0,"custom-class":"drawer","close-on-press-escape":!0},{default:d(()=>[b("div",$e,[i(ie,{modelValue:l(e).activeTab,"onUpdate:modelValue":t[10]||(t[10]=o=>l(e).activeTab=o),stretch:!0},{default:d(()=>[i(z,{label:"\u57FA\u672C\u4FE1\u606F",name:"first"},{default:d(()=>[i(S,{ref:"form",model:l(e).form},{default:d(()=>[i(w,{prop:"deviceName",label:"\u8BBE\u5907\u540D\u79F0","label-width":l(e).formLabelWidth,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BBE\u5907\u540D\u79F0",trigger:"blur"}]},{default:d(()=>[i(r,{modelValue:l(e).form.deviceName,"onUpdate:modelValue":t[4]||(t[4]=o=>l(e).form.deviceName=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),i(w,{prop:"deviceCode",label:"\u8BBE\u5907\u7F16\u53F7","label-width":l(e).formLabelWidth,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BBE\u5907\u7F16\u53F7",trigger:"blur"}]},{default:d(()=>[i(r,{modelValue:l(e).form.deviceCode,"onUpdate:modelValue":t[5]||(t[5]=o=>l(e).form.deviceCode=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),i(w,{prop:"appId",label:"Application","label-width":l(e).formLabelWidth,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5E94\u7528\u540D\u79F0",trigger:"blur"}]},{default:d(()=>[i(q,{modelValue:l(e).form.appId,"onUpdate:modelValue":t[6]||(t[6]=o=>l(e).form.appId=o),placeholder:"\u8BF7\u9009\u62E9\u5E94\u7528\u540D\u79F0"},{default:d(()=>[(n(!0),I(L,null,k(l(e).applications,o=>(n(),c(T,{label:o.name,value:o.appId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(e).form.appId.length>0?(n(),c(w,{key:0,prop:"appId",label:"AppId","label-width":l(e).formLabelWidth},{default:d(()=>[i(r,{modelValue:l(e).form.appId,"onUpdate:modelValue":t[7]||(t[7]=o=>l(e).form.appId=o),readonly:"",disabled:""},null,8,["modelValue"])]),_:1},8,["label-width"])):W("",!0),i(w,{prop:"deviceCategoryId",label:"\u8BBE\u5907\u7C7B\u578B","label-width":l(e).formLabelWidth,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BBE\u5907\u7C7B\u578B",trigger:"blur"}]},{default:d(()=>[i(q,{modelValue:l(e).form.deviceCategoryId,"onUpdate:modelValue":t[8]||(t[8]=o=>l(e).form.deviceCategoryId=o),placeholder:"\u8BBE\u5907\u7C7B\u578B",disabled:l(e).drawerType!=1},{default:d(()=>[(n(!0),I(L,null,k(l(e).categories,o=>(n(),I("div",{key:o.id,item:o},[i(T,{label:o.description,value:o.id},null,8,["label","value"])],8,We))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label-width"]),i(w,null,{default:d(()=>[b("div",Be,[v((n(),c(u,{class:"subButton",type:"primary",loading:l(e).drawerLoading,onClick:O},{default:d(()=>[m(y(l(e).drawerLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["loading"])),[[g]])])]),_:1})]),_:1},8,["model"])]),_:1}),i(z,{label:"\u9AD8\u7EA7\u914D\u7F6E",disabled:l(e).drawerType==1},{default:d(()=>[i(S,{ref:"advancedForm",model:l(e).advancedForm,size:"mini","label-suffix":":"},{default:d(()=>[i(w,null,{default:d(()=>[b("div",Ke,[v((n(),c(u,{type:"danger",size:"large",onClick:t[9]||(t[9]=o=>l(e).uploadDialog=!0)},{default:d(()=>[Ee]),_:1})),[[g]]),v((n(),c(u,{type:"primary",size:"large",onClick:G},{default:d(()=>[Oe]),_:1})),[[g]])])]),_:1}),(n(!0),I(L,null,k(l(e).configModels,o=>(n(),c(w,{key:o.id,item:o,label:o.configName,"label-width":l(e).formLabelWidth,rules:[{required:o.isRequired==20,message:"\u5FC5\u9700\u5B57\u6BB5",trigger:"blur"}]},{default:d(()=>[i(r,{modelValue:o.configModelValue,"onUpdate:modelValue":_=>o.configModelValue=_,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["item","label","label-width","rules"]))),128))]),_:1},8,["model"])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])])]),_:1},8,["title","modelValue"]),i(F,{title:"\u8BF7\u9009\u62E9\u4E0A\u4F20\u547D\u4EE4",modelValue:l(e).uploadDialog,"onUpdate:modelValue":t[14]||(t[14]=o=>l(e).uploadDialog=o),width:"30%"},{default:d(()=>[i(re,{modelValue:l(e).advancedForm.templateId,"onUpdate:modelValue":t[12]||(t[12]=o=>l(e).advancedForm.templateId=o),options:l(e).templates,filterable:""},{default:d(({node:o,data:_})=>[b("span",null,y(_.label),1),o.isLeaf?W("",!0):(n(),I("span",Pe,"("+y(_.children.length)+")",1))]),_:1},8,["modelValue","options"]),b("span",je,[i(u,{onClick:t[13]||(t[13]=o=>l(e).uploadDialog=!1)},{default:d(()=>[Je]),_:1}),v((n(),c(u,{type:"primary",onClick:Z},{default:d(()=>[Re]),_:1})),[[g]])])]),_:1},8,["modelValue"]),i(F,{title:"\u8F68\u8FF9\u5730\u56FE",modelValue:l(e).deviceTrackVisible,"onUpdate:modelValue":t[16]||(t[16]=o=>l(e).deviceTrackVisible=o),width:"80%",height:"80%"},{default:d(()=>[He,b("span",Xe,[i(u,{onClick:t[15]||(t[15]=o=>l(e).deviceTrackVisible=!1)},{default:d(()=>[Ge]),_:1})])]),_:1},8,["modelValue"])])])}}};var aa=Te(Qe,[["__scopeId","data-v-7a5b90b2"]]);export{aa as default};
