import{g as ee,e as oe,a as D,b as te,d as le,s as se}from"./user.f370ff63.js";import ae from"./userAdd.58e7dffe.js";import{a as re}from"./index.d0f5265b.js";import{h as ne,o as ie,j as i,a4 as ue,k as F,l as h,x as l,y as a,w as de,a5 as r,B as f,W as me,U as ce,O as b,q as d,s as N,J as v,D as fe,E as I}from"./vendor.a22db959.js";import"./index.6b1aa83f.js";const pe={class:"app-container"},ge=d("\u67E5\u8BE2"),_e=d("\u65B0\u589E"),be=d("\u7F16\u8F91"),Ie=d("\u914D\u7F6E\u89D2\u8272"),he=d("\u505C\u7528"),we=d("\u542F\u7528"),ke={style:{"text-align":"right",right:"15px",bottom:"15px",position:"absolute"}},ye=d("\u672A\u6FC0\u6D3B"),Ne=d("\u5DF2\u6FC0\u6D3B"),Ue={class:"dialog-footer"},Ce=d("\u53D6 \u6D88"),Ve=d("\u786E \u5B9A"),De={class:"select-tree"},Fe={class:"dialog-footer"},ve=d("\u786E \u5B9A"),Ae={setup(xe){const{proxy:g}=fe(),o=ne({drawer:!1,firstOpen:!1,userNo:"",status:"",statusList:[],showUserInfoDialog:!1,showRoleDialog:!1,formLabelWidth:"120px",selectUserId:"",userId:parseInt(window.localStorage.getItem("userId")||""),roleTree:[{id:1,label:"Administrator"},{id:2,label:"EHS\u6280\u672F\u5458"},{id:3,label:"\u8BBE\u5907\u7BA1\u7406\u5458"},{id:4,label:"\u8BBE\u5907Manager"},{id:5,label:"\u8BBE\u5907\u4F7F\u7528\u8005"},{id:6,label:"\u7CFB\u7EDF\u7BA1\u7406\u5458"}],permission:!0,tableData:{pagination:{total:0,pageNum:1,pageSize:10,totalPage:0},rows:[]},loading:!1,userInfoForm:{userId:"",userName:"",userNo:"",email:"",phone:"",status:""},rules:{userNo:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u7F16\u53F7",trigger:"blur"}],userName:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",trigger:"blur"}],email:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u5730\u5740",trigger:"blur"},{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur"]}],phone:[{min:11,max:11,message:"\u957F\u5EA6\u4E3A11\u4E2A\u5B57\u7B26",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{min:6,message:"\u957F\u5EA6\u5927\u4E8E6\u4E2A\u5B57\u7B26",trigger:"blur"}]}});ie(()=>{p(),x(12)});function w(s,e){var n=[];switch(e){case 12:n=o.statusList;break}for(let u=0;u<n.length;u++)if(s==n[u].itemId)return n[u].itemName;return""}function x(s){re({groupId:s}).then(e=>{if(e.code==200&&e.items.length>0)switch(s){case 12:o.statusList=e.items;break}}).catch(e=>{console.log(e)})}function z(s){o.tableData.pagination.pageSize=s,p()}function $(s){o.tableData.pagination.pageNum=s,p()}function R(){o.tableData.pagination.pageNum=1,p()}function p(){ee({pageNo:o.tableData.pagination.pageNum,pageSize:o.tableData.pagination.pageSize,userNo:o.userNo,status:o.status}).then(s=>{s&&s.code===200&&(o.tableData.pagination.totalPage=s.totalPage,o.tableData.rows=s.items?s.items:[])})}function S(s,e){P(e)}function L(){g.$refs.userInfoForm.resetFields()}function A(){g.$refs.userInfoForm.validate(s=>{s&&oe({userId:o.userInfoForm.userId,userName:o.userInfoForm.userName,userNo:o.userInfoForm.userNo,email:o.userInfoForm.email,phone:o.userInfoForm.phone}).then(e=>{e&&e.code===200&&(o.showUserInfoDialog=!1,I.success("\u4FEE\u6539\u6210\u529F"),p())})})}function j(s,e){o.showRoleDialog=!0,o.selectUserId=e.userId,D({userId:e.userId}).then(n=>{n&&n.code===200&&(n.roles&&n.roles.length>0?g.$refs.roles.setCheckedKeys(n.roles):g.$refs.roles.setCheckedKeys([]))})}function q(){g.$refs.roles.setCheckedKeys([]),o.selectUserId=""}function E(s,e){for(var n=0;n<e.checkedKeys.length;n++)if(s.id===e.checkedKeys[n]){K(s);return}B(s)}function K(s){te({uid:o.selectUserId,rid:s.id}).then(e=>{e&&e.code===200?I.success("\u6DFB\u52A0\u6743\u9650\u6210\u529F\uFF1A"+s.label):I.success("\u64CD\u4F5C\u5931\u8D25")}).catch(e=>{console.error(e)})}function B(s){!(o.selectUserId&&s.id)||le({userId:o.selectUserId,roleId:s.id}).then(e=>{e&&e.code===200?I.success("\u53D6\u6D88\u6743\u9650\u6210\u529F\uFF1A"+s.label):I.success("\u64CD\u4F5C\u5931\u8D25")}).catch(e=>{console.error(e)})}function M(){g.$refs.roles.setCheckedKeys([]),o.selectUserId="",o.showRoleDialog=!1}function P(s){D({userId:s.userId}).then(e=>{e&&e.code===200&&(o.showUserInfoDialog=!0,o.userInfoForm.userId=e.userId,o.userInfoForm.userName=e.userName,o.userInfoForm.userNo=e.userNo,o.userInfoForm.email=e.email,o.userInfoForm.phone=e.phone,o.userInfoForm.status=e.status)})}function k(s,e){se({userId:s.userId,status:e}).then(n=>{n&&n.code===200&&(I.success("\u4FEE\u6539\u6210\u529F"),p())})}function T(s){p(),s()}return(s,e)=>{const n=i("el-input"),u=i("el-form-item"),O=i("el-option"),W=i("el-select"),m=i("el-button"),U=i("el-form"),_=i("el-table-column"),y=i("el-tag"),H=i("el-table"),J=i("el-pagination"),C=i("el-radio"),G=i("el-radio-group"),V=i("el-dialog"),Q=i("el-tree"),X=i("el-scrollbar"),Y=i("el-drawer"),Z=ue("loading");return f(),F("div",pe,[h("div",null,[l(U,{inline:!0,class:"demo-form-inline",size:"small"},{default:a(()=>[l(u,{label:""},{default:a(()=>[l(n,{modelValue:r(o).userNo,"onUpdate:modelValue":e[0]||(e[0]=t=>r(o).userNo=t),modelModifiers:{trim:!0},clearable:"",placeholder:"\u7528\u6237\u7F16\u53F7"},null,8,["modelValue"])]),_:1}),l(u,{label:""},{default:a(()=>[l(W,{modelValue:r(o).status,"onUpdate:modelValue":e[1]||(e[1]=t=>r(o).status=t),clearable:"",placeholder:"\u72B6\u6001"},{default:a(()=>[(f(!0),F(me,null,ce(r(o).statusList,t=>(f(),b(O,{key:t.itemId,label:t.itemName,value:t.itemId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(m,{type:"primary",icon:"el-icon-search",onClick:R},{default:a(()=>[ge]),_:1})]),_:1}),l(u,null,{default:a(()=>[l(m,{type:"primary",icon:"el-icon-plus",size:"small",onClick:e[2]||(e[2]=t=>r(o).drawer=!0)},{default:a(()=>[_e]),_:1})]),_:1})]),_:1}),de(l(H,{border:"",data:r(o).tableData.rows,"max-height":"400px","cell-style":{padding:"3px"},stripe:"",style:{width:"100%"}},{default:a(()=>[l(_,{prop:"userNo",label:"\u7528\u6237\u7F16\u53F7",width:"100px"}),l(_,{prop:"userName",label:"\u7528\u6237\u540D\u79F0"}),l(_,{prop:"phone",label:"\u624B\u673A\u53F7",width:"120px"}),l(_,{prop:"email",label:"\u90AE\u7BB1"}),l(_,{label:"\u72B6\u6001",width:"80px"},{default:a(t=>[t.row.status===20?(f(),b(y,{key:0,type:"success",size:"mini","disable-transitions":""},{default:a(()=>[d(N(w(t.row.status,12)),1)]),_:2},1024)):t.row.status===50?(f(),b(y,{key:1,type:"danger",size:"mini","disable-transitions":""},{default:a(()=>[d(N(w(t.row.status,12)),1)]),_:2},1024)):(f(),b(y,{key:2,type:"info",size:"mini","disable-transitions":""},{default:a(()=>[d(N(w(t.row.status,12)),1)]),_:2},1024))]),_:1}),l(_,{label:"\u64CD\u4F5C",width:"300"},{default:a(t=>[l(m,{size:"mini",type:"default",icon:"el-icon-edit",disabled:t.row.userId===1,onClick:c=>S(t.$index,t.row)},{default:a(()=>[be]),_:2},1032,["disabled","onClick"]),l(m,{size:"mini",type:"primary",icon:"el-icon-setting",disabled:t.row.userId===1,onClick:c=>j(t.$index,t.row)},{default:a(()=>[Ie]),_:2},1032,["disabled","onClick"]),t.row.status!=50?(f(),b(m,{key:0,size:"mini",type:"danger",icon:"el-icon-circle-close",disabled:t.row.userId===1,onClick:c=>k(t.row,50)},{default:a(()=>[he]),_:2},1032,["disabled","onClick"])):v("",!0),t.row.status===50?(f(),b(m,{key:1,size:"mini",type:"warning",icon:"el-icon-circle-check",disabled:t.row.userId===1,onClick:c=>k(t.row,20)},{default:a(()=>[we]),_:2},1032,["disabled","onClick"])):v("",!0)]),_:1})]),_:1},8,["data"]),[[Z,r(o).loading]]),h("div",ke,[l(J,{"current-page":r(o).tableData.pagination.pageNum,"page-sizes":[10,20,50,100],"page-size":r(o).tableData.pagination.pageSize,background:"",layout:"total, sizes, prev, pager, next, jumper","page-count":r(o).tableData.pagination.totalPage,onSizeChange:z,onCurrentChange:$},null,8,["current-page","page-size","page-count"])]),l(V,{title:"\u4FEE\u6539\u7528\u6237\u4FE1\u606F",modelValue:r(o).showUserInfoDialog,"onUpdate:modelValue":e[11]||(e[11]=t=>r(o).showUserInfoDialog=t),"close-on-click-modal":!1,onClose:L},{default:a(()=>[l(U,{ref:(t,c)=>{c.userInfoForm=t},"status-icon":"",size:"small",model:r(o).userInfoForm,rules:r(o).rules,"label-width":"100px"},{default:a(()=>[l(u,{label:"\u7528\u6237\u7F16\u53F7",prop:"userNo"},{default:a(()=>[l(n,{modelValue:r(o).userInfoForm.userNo,"onUpdate:modelValue":e[3]||(e[3]=t=>r(o).userInfoForm.userNo=t),clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u7528\u6237\u59D3\u540D",prop:"userName"},{default:a(()=>[l(n,{modelValue:r(o).userInfoForm.userName,"onUpdate:modelValue":e[4]||(e[4]=t=>r(o).userInfoForm.userName=t),clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u90AE\u7BB1",prop:"email"},{default:a(()=>[l(n,{modelValue:r(o).userInfoForm.email,"onUpdate:modelValue":e[5]||(e[5]=t=>r(o).userInfoForm.email=t),clearable:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u624B\u673A\u53F7",prop:"phone"},{default:a(()=>[l(n,{modelValue:r(o).userInfoForm.phone,"onUpdate:modelValue":e[6]||(e[6]=t=>r(o).userInfoForm.phone=t),clearable:"",maxlength:"11"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u72B6\u6001"},{default:a(()=>[l(G,{modelValue:r(o).userInfoForm.status,"onUpdate:modelValue":e[7]||(e[7]=t=>r(o).userInfoForm.status=t),onChange:e[8]||(e[8]=t=>k(r(o).userInfoForm,r(o).userInfoForm.status))},{default:a(()=>[l(C,{label:10},{default:a(()=>[ye]),_:1}),l(C,{label:20},{default:a(()=>[Ne]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),h("span",Ue,[l(m,{size:"small",onClick:e[9]||(e[9]=t=>r(o).showUserInfoDialog=!1)},{default:a(()=>[Ce]),_:1}),l(m,{size:"small",type:"primary",onClick:e[10]||(e[10]=t=>A())},{default:a(()=>[Ve]),_:1})])]),_:1},8,["modelValue"]),l(V,{title:"\u914D\u7F6E\u7528\u6237\u89D2\u8272",modelValue:r(o).showRoleDialog,"onUpdate:modelValue":e[13]||(e[13]=t=>r(o).showRoleDialog=t),"close-on-click-modal":!1,close:q},{default:a(()=>[h("div",De,[l(X,{tag:"div",class:"is-empty","wrap-class":"el-select-dropdown__wrap","view-class":"el-select-dropdown__list"},{default:a(()=>[l(Q,{ref:(t,c)=>{c.roles=t},data:r(o).roleTree,"show-checkbox":"","check-on-click-node":"","node-key":"id",onCheck:E},null,8,["data"])]),_:1})]),h("span",Fe,[l(m,{size:"small",type:"primary",onClick:e[12]||(e[12]=t=>M())},{default:a(()=>[ve]),_:1})])]),_:1},8,["modelValue"])]),l(Y,{title:"\u65B0\u589E\u7528\u6237",modelValue:r(o).drawer,"onUpdate:modelValue":e[14]||(e[14]=t=>r(o).drawer=t),"destroy-on-close":!0,"custom-class":"drawer",ref:(t,c)=>{c.drawer=t},"close-on-press-escape":!0,"before-close":T},{default:a(()=>[l(ae)]),_:1},8,["modelValue"])])}}};export{Ae as default};
