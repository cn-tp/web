import J from"./addSpu.29a0fe4d.js";import{h as O,Z as W,o as Z,j as i,a4 as G,k as _,l as v,x as o,y as s,a5 as l,w as K,O as m,J as Q,B as r,W as V,U as C,s as I,q as b,E as U,D as X}from"./vendor.a22db959.js";import{f as Y,a as ee,h as ae,i as te}from"./index.70831d5c.js";import{_ as le}from"./index.465eb10d.js";const oe=b("\u641C\u7D22"),se=b("\u65B0\u589E"),ne=b("\u4FEE\u6539"),ue={footer:"",class:"dialog_footer"},ie=b("\u53D6 \u6D88"),re=b("\u786E \u5B9A"),de={setup(pe){const{proxy:h}=X(),e=O({drawer:!1,seachField:{spuName:"",spuNo:"",status:"",spuConsumeRule:""},tableData:{loading:!1,pagination:{pageSize:10,pageNum:1,totalPage:0,more:0},rows:[]},formData:{userId:parseInt(window.localStorage.getItem("userId")||""),sessionId:window.localStorage.getItem("sessionId"),spuId:"",spuNo:"",spuName:"",description:"",spuConsumeRule:0,status:"",coperationId:"",moperationId:"",ctime:"",mtime:""},rules:{spuNo:[{required:!0,message:"\u8BF7\u8F93\u5165SPU\u7F16\u53F7",trigger:"blur"}],spuName:[{required:!0,message:"\u8BF7\u8F93\u5165SPU\u540D\u79F0",trigger:"blur"}],spuConsumeRule:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F7F\u7528\u89C4\u5219",trigger:"blur"}]},canDialogDetail:!1,statusList:[],spuConsumeRuleList:[]});W();function k(n){e.tableData.pagination.pageSize=n,c()}function x(n){e.tableData.pagination.pageNum=n,c()}function z(){e.tableData.pagination.pageNum=1,c()}function c(){e.tableData.loading=!0,Y({spuName:e.seachField.spuName,spuNo:e.seachField.spuNo,spuConsumeRule:e.seachField.spuConsumeRule,status:e.seachField.status,pageSize:e.tableData.pagination.pageSize,pageNum:e.tableData.pagination.pageNum}).then(n=>{console.log(n),e.tableData.rows=n.items?n.items:[],e.tableData.pagination.totalPage=n.totalPage,e.tableData.loading=!1}).catch(n=>{console.log(n)})}function P(){return"padding:3px;"}function F(){return"padding:3px;"}function R(n,t){e.formData.id&&h.$refs.ruleForm.resetFields(),ae({id:t.spuId}).then(u=>{e.formData=u.data,e.canDialogDetail=!0}).catch(u=>{console.log(u)})}function L(){h.$refs.ruleForm.validate().then(n=>{n&&te(e.formData).then(()=>{U.success("\u4FEE\u6539\u6210\u529F"),e.canDialogDetail=!1,c()}).catch(()=>{U.error("\u64CD\u4F5C\u5931\u8D25")})})}function $(n){c(),n()}function S(n,t){var u=[];switch(t){case 1:u=e.statusList;break;case 2:u=e.spuConsumeRuleList;break}for(let d=0;d<u.length;d++)if(n==u[d].itemId)return u[d].itemName;return""}function y(n){ee({groupId:n}).then(t=>{if(t.code==200&&t.items.length>0)switch(n){case 1:e.statusList=t.items;break;case 2:e.spuConsumeRuleList=t.items;break}}).catch(t=>{console.log(t)})}return Z(()=>{c(),y(1),y(2)}),(n,t)=>{const u=i("el-input"),d=i("el-col"),D=i("el-option"),w=i("el-select"),f=i("el-button"),j=i("el-row"),p=i("el-table-column"),A=i("el-table"),B=i("el-empty"),q=i("el-pagination"),g=i("el-form-item"),E=i("el-form"),H=i("el-dialog"),M=i("el-drawer"),T=G("loading");return r(),_("div",null,[v("div",null,[o(j,{gutter:20},{default:s(()=>[o(d,{span:4},{default:s(()=>[o(u,{modelValue:l(e).seachField.spuName,"onUpdate:modelValue":t[0]||(t[0]=a=>l(e).seachField.spuName=a),placeholder:"SPU\u540D\u79F0",size:"small",clearable:!0},null,8,["modelValue"])]),_:1}),o(d,{span:4},{default:s(()=>[o(u,{modelValue:l(e).seachField.spuNo,"onUpdate:modelValue":t[1]||(t[1]=a=>l(e).seachField.spuNo=a),placeholder:"SPU\u7F16\u53F7",size:"small",clearable:!0},null,8,["modelValue"])]),_:1}),o(d,{span:4},{default:s(()=>[o(w,{modelValue:l(e).seachField.status,"onUpdate:modelValue":t[2]||(t[2]=a=>l(e).seachField.status=a),placeholder:"\u72B6\u6001",size:"small",clearable:""},{default:s(()=>[(r(!0),_(V,null,C(l(e).statusList,a=>(r(),m(D,{label:a.itemName,value:a.itemId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),o(d,{span:4},{default:s(()=>[o(w,{modelValue:l(e).seachField.spuConsumeRule,"onUpdate:modelValue":t[3]||(t[3]=a=>l(e).seachField.spuConsumeRule=a),placeholder:"SPU\u4F7F\u7528\u89C4\u5219",size:"small",clearable:""},{default:s(()=>[(r(!0),_(V,null,C(l(e).spuConsumeRuleList,a=>(r(),m(D,{label:a.itemName,value:a.itemId},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),o(d,{span:2},{default:s(()=>[o(f,{type:"primary",onClick:t[4]||(t[4]=a=>z()),size:"small"},{default:s(()=>[oe]),_:1})]),_:1}),o(d,{span:2},{default:s(()=>[o(f,{type:"primary",onClick:t[5]||(t[5]=a=>l(e).drawer=!0),size:"small"},{default:s(()=>[se]),_:1})]),_:1})]),_:1}),l(e).tableData.rows.length>0?K((r(),m(A,{key:0,data:l(e).tableData.rows,stripe:"","cell-style":P,"header-cell-style":F,border:"",class:"container_table"},{default:s(()=>[o(p,{label:"#",prop:"spuId",width:"50"}),o(p,{label:"SPU\u7F16\u53F7",prop:"spuNo","show-overflow-tooltip":""}),o(p,{label:"SPU\u540D\u79F0",prop:"spuName","show-overflow-tooltip":""}),o(p,{label:"\u4F7F\u7528\u89C4\u5219",prop:"spuConsumeRule","show-overflow-tooltip":""},{default:s(a=>[v("div",null,I(S(a.row.spuConsumeRule,2)),1)]),_:1}),o(p,{label:"SPU\u63CF\u8FF0",prop:"description","show-overflow-tooltip":""}),o(p,{label:"\u72B6\u6001",prop:"status",width:"80","show-overflow-tooltip":""},{default:s(a=>[v("div",null,I(S(a.row.status,1)),1)]),_:1}),o(p,{label:"\u64CD\u4F5C",width:"120"},{default:s(a=>[o(f,{type:"text",onClick:N=>R(a.$index,a.row),size:"mini"},{default:s(()=>[ne]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[T,l(e).tableData.loading]]):(r(),m(B,{key:1,description:"\u6682\u65E0\u6570\u636E"})),l(e).tableData.rows.length>0?(r(),m(q,{key:2,currentPage:l(e).tableData.pagination.pageNum,"onUpdate:currentPage":t[6]||(t[6]=a=>l(e).tableData.pagination.pageNum=a),"page-size":l(e).tableData.pagination.pageSize,layout:"prev, pager, next",onCurrentChange:x,onSizeChange:k,"page-count":l(e).tableData.pagination.totalPage},null,8,["currentPage","page-size","page-count"])):Q("",!0),o(H,{title:"\u4FEE\u6539SPU\u4FE1\u606F",modelValue:l(e).canDialogDetail,"onUpdate:modelValue":t[14]||(t[14]=a=>l(e).canDialogDetail=a),center:"",width:"30%"},{default:s(()=>[o(E,{ref:(a,N)=>{N.ruleForm=a},model:l(e).formData,rules:l(e).rules,size:"mini","label-width":"100px"},{default:s(()=>[o(g,{label:"SPU\u7F16\u53F7",prop:"spuNo"},{default:s(()=>[o(u,{modelValue:l(e).formData.spuNo,"onUpdate:modelValue":t[7]||(t[7]=a=>l(e).formData.spuNo=a)},null,8,["modelValue"])]),_:1}),o(g,{label:"SPU\u540D\u79F0",prop:"spuName"},{default:s(()=>[o(u,{modelValue:l(e).formData.spuName,"onUpdate:modelValue":t[8]||(t[8]=a=>l(e).formData.spuName=a)},null,8,["modelValue"])]),_:1}),o(g,{label:"\u4F7F\u7528\u89C4\u5219",prop:"spuConsumeRule"},{default:s(()=>[o(w,{modelValue:l(e).formData.spuConsumeRule,"onUpdate:modelValue":t[9]||(t[9]=a=>l(e).formData.spuConsumeRule=a),size:"small"},{default:s(()=>[(r(!0),_(V,null,C(l(e).spuConsumeRuleList,a=>(r(),m(D,{label:a.itemName,value:a.itemId,key:a.itemId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(g,{label:"SPU\u63CF\u8FF0",prop:"description"},{default:s(()=>[o(u,{modelValue:l(e).formData.description,"onUpdate:modelValue":t[10]||(t[10]=a=>l(e).formData.description=a)},null,8,["modelValue"])]),_:1}),o(g,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[o(w,{modelValue:l(e).formData.status,"onUpdate:modelValue":t[11]||(t[11]=a=>l(e).formData.status=a),size:"small"},{default:s(()=>[(r(!0),_(V,null,C(l(e).statusList,a=>(r(),m(D,{label:a.itemName,value:a.itemId,key:a.itemId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),v("span",ue,[o(f,{onClick:t[12]||(t[12]=a=>l(e).canDialogDetail=!1)},{default:s(()=>[ie]),_:1}),o(f,{type:"primary",onClick:t[13]||(t[13]=a=>L())},{default:s(()=>[re]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),o(M,{title:"\u65B0\u589E spu",modelValue:l(e).drawer,"onUpdate:modelValue":t[15]||(t[15]=a=>l(e).drawer=a),"destroy-on-close":!0,"custom-class":"drawer",ref:(a,N)=>{N.drawer=a},"close-on-press-escape":!0,"before-close":$},{default:s(()=>[o(J)]),_:1},8,["modelValue"])])}}};var _e=le(de,[["__scopeId","data-v-5d6c2c4d"]]);export{_e as default};
