import{K as F,h as M,o as W,E as N,j as _,k as h,s as o,x as s,a5 as n,A as m,a6 as $,B as p,C as R,q as f,J as X,X as G,W as H,w as x,O as S,p as g,D as Q}from"./vendor.8327e786.js";import{C as Y,D as Z,m as ee}from"./index.9e1fbb07.js";import"./index.10c62aa1.js";const te={class:"app-container"},ae={id:"app",slot:"body"},oe={key:0},le=["item"],ne=g("\u641C\u7D22"),se=g("\u65B0\u589E"),ie={style:{"text-align":"right","margin-top":"15px"}},me={class:"drawer__content"},ue={setup(re){const{proxy:w}=Q();F();const e=M({tableData:{pagination:{pageNum:1,pageSize:20,totalPage:0},rows:[]},queryDatas:{clientId:"",commands:[],status:null},drawer:!1,drawerLoading:!1,form:{id:null,clientId:"",command:null,subCommand:null,payload:"",status:null,ctime:"",mtime:""},formLabelWidth:"120px",drawerType:1,taskStatusDict:[],commandList:[],subCommandList:[],commands:[]});W(()=>{z(4,20),T(),u()});function k(t){e.tableData.pagination.pageSize=t,u()}function V(t){e.tableData.pagination.pageNum=t,u()}function D(){e.tableData.pagination.pageNum=1,u()}function u(){Y({clientId:e.queryDatas.clientId,command:e.queryDatas.command,subCommand:e.queryDatas.subCommand,status:e.queryDatas.status,pageNum:e.tableData.pagination.pageNum,pageSize:e.tableData.pagination.pageSize}).then(t=>{t&&t.code===200?(e.tableData.rows=t.items,e.tableData.pagination.totalPage=t.totalPage):N.error(t.code+": "+t.message)}).catch(t=>{console.log(t)})}function I(){e.drawerType=1,e.drawer=!0}function q(t){e.drawerLoading||(w.$refs.form!==void 0&&w.$refs.form.resetFields(),e.drawerLoading=!1,e.drawer=!1,u())}function z(t,a){Z({groupId:t,status:a}).then(i=>{if(i&&i.code==200&&i.items&&i.items.length>0)switch(t){case 4:e.taskStatusDict=i.items;default:return}})}function b(t,a){if(t&&a.length>0){for(var i=0;i<a.length;i++)if(t==a[i].itemId)return a[i].itemName}else return""}function T(){ee({}).then(t=>{if(t&&t.code===200){if(t.items&&t.items.length>0){e.templateList=[];for(var a=0;a<t.items.length;a++)e.templateList.push(t.items[a]);O()}}else N.error(t.code+": "+t.message)}).catch(t=>{console.log(t)})}function O(){e.commands=[],e.commandList=[],e.subCommandList=[];for(var t=0;t<e.templateList.length;t++){var a={label:e.templateList[t].commandDesc,value:e.templateList[t].command,children:[]},i={itemId:e.templateList[t].command,itemName:e.templateList[t].commandDesc},r={itemId:e.templateList[t].subCommand,itemName:e.templateList[t].subCommandDesc};JSON.stringify(e.commands).indexOf(JSON.stringify(a))===-1&&e.commands.push(a);for(var c=0;c<e.commands.length;c++){e.templateList[t].command===e.commands[c].value&&e.commands[c].children.push({label:e.templateList[t].subCommandDesc,value:e.templateList[t].subCommand});break}JSON.stringify(e.commandList).indexOf(JSON.stringify(i))===-1&&e.commandList.push(i),e.subCommandList.push(r)}console.log(e.commands)}function A(){return"padding:3px;"}function B(){return"padding:3px;"}return(t,a)=>{const i=m("el-input"),r=m("el-col"),c=m("el-cascader"),J=m("el-option"),K=m("el-select"),y=m("el-button"),v=m("el-row"),d=m("el-table-column"),P=m("el-table"),U=m("el-pagination"),j=m("el-form"),E=m("el-drawer"),C=$("waves");return p(),_("div",te,[h("div",ae,[o(v,{gutter:20},{default:s(()=>[o(r,{span:4},{default:s(()=>[o(i,{modelValue:n(e).queryDatas.clientId,"onUpdate:modelValue":a[0]||(a[0]=l=>n(e).queryDatas.clientId=l),modelModifiers:{trim:!0},placeholder:"appId",class:"filter-item",clearable:"",onKeyup:R(D,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1}),o(r,{span:4},{default:s(()=>[o(c,{modelValue:n(e).queryDatas.commands,"onUpdate:modelValue":a[1]||(a[1]=l=>n(e).queryDatas.commands=l),options:n(e).commands,filterable:""},{default:s(({node:l,data:L})=>[h("span",null,f(L.label),1),l.isLeaf?X("",!0):(p(),_("span",oe,"("+f(L.children.length)+")",1))]),_:1},8,["modelValue","options"])]),_:1}),o(r,{span:4},{default:s(()=>[o(K,{modelValue:n(e).queryDatas.status,"onUpdate:modelValue":a[2]||(a[2]=l=>n(e).queryDatas.status=l),placeholder:"\u4EFB\u52A1\u72B6\u6001"},{default:s(()=>[(p(!0),_(G,null,H(n(e).taskStatusDict,l=>(p(),_("div",{key:l.itemId,item:l},[o(J,{label:l.itemName,value:l.itemId},null,8,["label","value"])],8,le))),128))]),_:1},8,["modelValue"])]),_:1}),o(r,{span:4},{default:s(()=>[x((p(),S(y,{class:"filter-item",plain:"",icon:"el-icon-search",onClick:D},{default:s(()=>[ne]),_:1})),[[C]])]),_:1})]),_:1}),o(v,{type:"flex",justify:"end"},{default:s(()=>[o(r,{span:4,style:{"text-align":"right","margin-top":"15px"}},{default:s(()=>[x((p(),S(y,{class:"filter-item",style:{"margin-left":"10px"},plain:"",icon:"el-icon-plus",onClick:I},{default:s(()=>[se]),_:1})),[[C]])]),_:1})]),_:1}),o(P,{data:n(e).tableData.rows,style:{width:"100%"},"cell-style":A,"header-cell-style":B},{default:s(()=>[o(d,{prop:"id",label:"#",width:"80","show-overflow-tooltip":""}),o(d,{prop:"clientId",label:"AppId","show-overflow-tooltip":""}),o(d,{prop:"command",label:"\u4EFB\u52A1\u7C7B\u578B","show-overflow-tooltip":""},{default:s(l=>[g(f(b(l.row.command,n(e).commandList)),1)]),_:1}),o(d,{prop:"subCommand",label:"\u6267\u884C\u5B50\u547D\u4EE4","show-overflow-tooltip":""},{default:s(l=>[g(f(b(l.row.subCommand,n(e).subCommandList)),1)]),_:1}),o(d,{prop:"status",label:"\u4EFB\u52A1\u72B6\u6001","show-overflow-tooltip":""},{default:s(l=>[g(f(b(l.row.status,n(e).taskStatusDict)),1)]),_:1}),o(d,{prop:"ctime",label:"\u521B\u5EFA\u65F6\u95F4","show-overflow-tooltip":""}),o(d,{prop:"mtime",label:"\u66F4\u65B0\u65F6\u95F4","show-overflow-tooltip":""})]),_:1},8,["data"]),h("div",ie,[o(U,{"current-page":n(e).tableData.pagination.pageNum,"pager-count":5,"page-sizes":[10,20,50,100],"page-size":n(e).tableData.pagination.pageSize,"page-count":n(e).tableData.pagination.totalPage,background:"",layout:"sizes, prev, pager, next, jumper",onSizeChange:k,onCurrentChange:V},null,8,["current-page","page-size","page-count"])]),o(E,{title:"\u4EFB\u52A1\u8BE6\u60C5 / "+(n(e).drawerType==1?"\u65B0\u589E":n(e).form.id),"before-close":q,modelValue:n(e).drawer,"onUpdate:modelValue":a[3]||(a[3]=l=>n(e).drawer=l),"destroy-on-close":!0,"custom-class":"drawer",ref:"drawer","close-on-press-escape":!0},{default:s(()=>[h("div",me,[o(j,{ref:"form",model:n(e).form},null,8,["model"])])]),_:1},8,["title","modelValue"])])])}}};export{ue as default};
