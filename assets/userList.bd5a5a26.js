import{g as le,a as ae,e as ne,b as v,c as re,d as ie,s as ue,r as de}from"./user.afc1ef84.js";import me from"./userAdd.e68122b6.js";import{D as ce}from"./index.9e1fbb07.js";import{h as fe,o as pe,j as F,k as w,s as l,x as a,w as ge,a5 as n,O as h,A as u,a6 as _e,B as f,X as he,W as be,p as d,q as D,J as z,D as Ie,E as p,a1 as $,a7 as we}from"./vendor.8327e786.js";import"./index.10c62aa1.js";const ye={class:"app-container"},ke=d("\u67E5\u8BE2"),Ce=d("\u65B0\u589E"),Ne=d("\u7F16\u8F91"),De=d("\u914D\u7F6E\u89D2\u8272"),Ue=d("\u91CD\u7F6E\u5BC6\u7801"),Ve=d("\u505C\u7528"),xe=d("\u542F\u7528"),ve={style:{"text-align":"right",right:"15px",bottom:"15px",position:"absolute"}},Fe=d("\u672A\u6FC0\u6D3B"),ze=d("\u5DF2\u6FC0\u6D3B"),$e={class:"dialog-footer"},Re=d("\u53D6 \u6D88"),Le=d("\u786E \u5B9A"),Be={class:"select-tree"},Se={class:"dialog-footer"},Ae=d("\u786E \u5B9A"),je={setup(Te){const{proxy:b}=Ie(),t=fe({drawer:!1,firstOpen:!1,userNo:"",status:"",statusList:[],showUserInfoDialog:!1,showRoleDialog:!1,formLabelWidth:"120px",selectUserId:"",userId:parseInt(window.localStorage.getItem("userId")||""),roleList:[],permission:!0,tableData:{pagination:{total:0,pageNum:1,pageSize:10,totalPage:0},rows:[]},loading:!1,userInfoForm:{userId:"",userName:"",userNo:"",email:"",phone:"",status:""},rules:{userNo:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u7F16\u53F7",trigger:"blur"}],userName:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",trigger:"blur"}],email:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u5730\u5740",trigger:"blur"},{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur"]}],phone:[{min:11,max:11,message:"\u957F\u5EA6\u4E3A11\u4E2A\u5B57\u7B26",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{min:6,message:"\u957F\u5EA6\u5927\u4E8E6\u4E2A\u5B57\u7B26",trigger:"blur"}]}});pe(()=>{g(),R(12),H()});function k(s,e){var r=[];switch(e){case 12:r=t.statusList;break}for(let i=0;i<r.length;i++)if(s==r[i].itemId)return r[i].itemName;return""}function R(s){ce({groupId:s}).then(e=>{if(e.code==200&&e.items.length>0)switch(s){case 12:t.statusList=e.items;break}}).catch(e=>{console.log(e)})}function L(s){t.tableData.pagination.pageSize=s,g()}function B(s){t.tableData.pagination.pageNum=s,g()}function S(){t.tableData.pagination.pageNum=1,g()}function g(){le({pageNo:t.tableData.pagination.pageNum,pageSize:t.tableData.pagination.pageSize,userNo:t.userNo,status:t.status}).then(s=>{s&&s.code===200&&(t.tableData.pagination.totalPage=s.totalPage,t.tableData.rows=s.items?s.items:[])})}function A(s,e){X(e)}function T(){b.$refs.userInfoForm.resetFields()}function P(){b.$refs.userInfoForm.validate(s=>{s&&ne({userId:t.userInfoForm.userId,userName:t.userInfoForm.userName,userNo:t.userInfoForm.userNo,email:t.userInfoForm.email,phone:t.userInfoForm.phone}).then(e=>{e&&e.code===200&&(t.showUserInfoDialog=!1,p.success("\u4FEE\u6539\u6210\u529F"),g())})})}function q(s,e){t.showRoleDialog=!0,t.selectUserId=e.userId,v({userId:e.userId}).then(r=>{r&&r.code===200&&(r.roles&&r.roles.length>0?b.$refs.roles.setCheckedKeys(r.roles):b.$refs.roles.setCheckedKeys([]))})}function E(){b.$refs.roles.setCheckedKeys([]),t.selectUserId=""}function K(s,e){for(var r=0;r<e.checkedKeys.length;r++)if(s.id===e.checkedKeys[r]){M(s);return}j(s)}function M(s){re({uid:t.selectUserId,rid:s.id}).then(e=>{e&&e.code===200?p.success("\u6DFB\u52A0\u6743\u9650\u6210\u529F\uFF1A"+s.label):p.success("\u64CD\u4F5C\u5931\u8D25")}).catch(e=>{console.error(e)})}function j(s){!(t.selectUserId&&s.id)||ie({userId:t.selectUserId,roleId:s.id}).then(e=>{e&&e.code===200?p.success("\u53D6\u6D88\u6743\u9650\u6210\u529F\uFF1A"+s.label):p.success("\u64CD\u4F5C\u5931\u8D25")}).catch(e=>{console.error(e)})}function O(s,e){var r=e.userName;$({title:"\u91CD\u7F6E\u5BC6\u7801\u63D0\u793A",message:"\u6B64\u64CD\u4F5C\u5C06\u91CD\u7F6E\u7528\u6237 "+r+" \u7684\u767B\u5F55\u5BC6\u7801, \u662F\u5426\u7EE7\u7EED?",showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",showClose:!1,beforeClose:(i,c,_)=>{i==="confirm"?(c.confirmButtonLoading=!0,c.showCancelButton=!1,c.confirmButtonText="\u91CD\u7F6E\u4E2D...",setTimeout(()=>{W(e),_(),setTimeout(()=>{c.confirmButtonLoading=!1},300)},3e3)):_()}}).then(i=>{p({type:"success",message:"\u64CD\u4F5C\u6210\u529F"})}).catch(i=>{})}function W(s){de({uid:s.userId}).then(e=>{$({message:"\u65B0\u5BC6\u7801(\u8BF7\u590D\u5236\u4FDD\u5B58): "+e.password,confirmButtonText:"\u786E\u5B9A",center:!0,beforeClose:(r,i,c)=>{r==="confirm"&&we(e.password,void 0,_=>{_?p.warning(`\u590D\u5236\u5931\u8D25: ${_} \uFF01`):p.success(`\u590D\u5236: ${e.password} \u6210\u529F\uFF01`)}),c()}})}).catch(e=>{})}function J(){b.$refs.roles.setCheckedKeys([]),t.selectUserId="",t.showRoleDialog=!1}function X(s){v({userId:s.userId}).then(e=>{e&&e.code===200&&(t.showUserInfoDialog=!0,t.userInfoForm.userId=e.userId,t.userInfoForm.userName=e.userName,t.userInfoForm.userNo=e.userNo,t.userInfoForm.email=e.email,t.userInfoForm.phone=e.phone,t.userInfoForm.status=e.status)})}function C(s,e){ue({userId:s.userId,status:e}).then(r=>{r&&r.code===200&&(p.success("\u4FEE\u6539\u6210\u529F"),g())})}function G(s){g(),s()}function H(){ae({}).then(s=>{if(s&&s.code===200&&s.items&&s.items.length>0)for(var e=0;e<s.items.length;e++)t.roleList.push({id:s.items[e].id,label:s.items[e].roleName})})}return(s,e)=>{const r=u("el-input"),i=u("el-form-item"),c=u("el-option"),_=u("el-select"),m=u("el-button"),U=u("el-form"),I=u("el-table-column"),N=u("el-tag"),Q=u("el-table"),Y=u("el-pagination"),V=u("el-radio"),Z=u("el-radio-group"),x=u("el-dialog"),ee=u("el-tree"),te=u("el-scrollbar"),oe=u("el-drawer"),se=_e("loading");return f(),F("div",ye,[w("div",null,[l(U,{inline:!0,class:"demo-form-inline",size:"small"},{default:a(()=>[l(i,{label:""},{default:a(()=>[l(r,{modelValue:n(t).userNo,"onUpdate:modelValue":e[0]||(e[0]=o=>n(t).userNo=o),modelModifiers:{trim:!0},clearable:"",placeholder:"\u7528\u6237\u7F16\u53F7"},null,8,["modelValue"])]),_:1}),l(i,{label:""},{default:a(()=>[l(_,{modelValue:n(t).status,"onUpdate:modelValue":e[1]||(e[1]=o=>n(t).status=o),clearable:"",placeholder:"\u72B6\u6001"},{default:a(()=>[(f(!0),F(he,null,be(n(t).statusList,o=>(f(),h(c,{key:o.itemId,label:o.itemName,value:o.itemId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(m,{type:"primary",icon:"el-icon-search",onClick:S},{default:a(()=>[ke]),_:1})]),_:1}),l(i,null,{default:a(()=>[l(m,{type:"primary",icon:"el-icon-plus",size:"small",onClick:e[2]||(e[2]=o=>n(t).drawer=!0)},{default:a(()=>[Ce]),_:1})]),_:1})]),_:1}),ge((f(),h(Q,{border:"",data:n(t).tableData.rows,"max-height":"400px","cell-style":{padding:"3px"},stripe:"",style:{width:"100%"}},{default:a(()=>[l(I,{prop:"userNo",label:"\u7528\u6237\u7F16\u53F7",width:"100px"}),l(I,{prop:"userName",label:"\u7528\u6237\u540D\u79F0"}),l(I,{prop:"phone",label:"\u624B\u673A\u53F7",width:"120px"}),l(I,{prop:"email",label:"\u90AE\u7BB1"}),l(I,{label:"\u72B6\u6001",width:"80px"},{default:a(o=>[o.row.status===20?(f(),h(N,{key:0,type:"success",size:"mini","disable-transitions":""},{default:a(()=>[d(D(k(o.row.status,12)),1)]),_:2},1024)):o.row.status===50?(f(),h(N,{key:1,type:"danger",size:"mini","disable-transitions":""},{default:a(()=>[d(D(k(o.row.status,12)),1)]),_:2},1024)):(f(),h(N,{key:2,type:"info",size:"mini","disable-transitions":""},{default:a(()=>[d(D(k(o.row.status,12)),1)]),_:2},1024))]),_:1}),l(I,{label:"\u64CD\u4F5C",width:"400"},{default:a(o=>[l(m,{size:"mini",type:"default",icon:"el-icon-edit",disabled:o.row.userId===1,onClick:y=>A(o.$index,o.row)},{default:a(()=>[Ne]),_:2},1032,["disabled","onClick"]),l(m,{size:"mini",type:"primary",icon:"el-icon-setting",disabled:o.row.userId===1,onClick:y=>q(o.$index,o.row)},{default:a(()=>[De]),_:2},1032,["disabled","onClick"]),l(m,{size:"mini",type:"primary",icon:"el-icon-RefreshRight",disabled:o.row.userId===1,onClick:y=>O(o.$index,o.row)},{default:a(()=>[Ue]),_:2},1032,["disabled","onClick"]),o.row.status!=50?(f(),h(m,{key:0,size:"mini",type:"danger",icon:"el-icon-circle-close",disabled:o.row.userId===1,onClick:y=>C(o.row,50)},{default:a(()=>[Ve]),_:2},1032,["disabled","onClick"])):z("",!0),o.row.status===50?(f(),h(m,{key:1,size:"mini",type:"warning",icon:"el-icon-circle-check",disabled:o.row.userId===1,onClick:y=>C(o.row,20)},{default:a(()=>[xe]),_:2},1032,["disabled","onClick"])):z("",!0)]),_:1})]),_:1},8,["data"])),[[se,n(t).loading]]),w("div",ve,[l(Y,{"current-page":n(t).tableData.pagination.pageNum,"page-sizes":[10,20,50,100],"page-size":n(t).tableData.pagination.pageSize,background:"",layout:"total, sizes, prev, pager, next, jumper","page-count":n(t).tableData.pagination.totalPage,onSizeChange:L,onCurrentChange:B},null,8,["current-page","page-size","page-count"])]),l(x,{title:"\u4FEE\u6539\u7528\u6237\u4FE1\u606F",modelValue:n(t).showUserInfoDialog,"onUpdate:modelValue":e[11]||(e[11]=o=>n(t).showUserInfoDialog=o),"close-on-click-modal":!1,onClose:T},{default:a(()=>[l(U,{ref:"userInfoForm","status-icon":"",size:"small",model:n(t).userInfoForm,rules:n(t).rules,"label-width":"100px"},{default:a(()=>[l(i,{label:"\u7528\u6237\u7F16\u53F7",prop:"userNo"},{default:a(()=>[l(r,{modelValue:n(t).userInfoForm.userNo,"onUpdate:modelValue":e[3]||(e[3]=o=>n(t).userInfoForm.userNo=o),clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u7528\u6237\u59D3\u540D",prop:"userName"},{default:a(()=>[l(r,{modelValue:n(t).userInfoForm.userName,"onUpdate:modelValue":e[4]||(e[4]=o=>n(t).userInfoForm.userName=o),clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u90AE\u7BB1",prop:"email"},{default:a(()=>[l(r,{modelValue:n(t).userInfoForm.email,"onUpdate:modelValue":e[5]||(e[5]=o=>n(t).userInfoForm.email=o),clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"\u624B\u673A\u53F7",prop:"phone"},{default:a(()=>[l(r,{modelValue:n(t).userInfoForm.phone,"onUpdate:modelValue":e[6]||(e[6]=o=>n(t).userInfoForm.phone=o),clearable:"",maxlength:"11"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u72B6\u6001"},{default:a(()=>[l(Z,{modelValue:n(t).userInfoForm.status,"onUpdate:modelValue":e[7]||(e[7]=o=>n(t).userInfoForm.status=o),onChange:e[8]||(e[8]=o=>C(n(t).userInfoForm,n(t).userInfoForm.status))},{default:a(()=>[l(V,{label:10},{default:a(()=>[Fe]),_:1}),l(V,{label:20},{default:a(()=>[ze]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),w("span",$e,[l(m,{size:"small",onClick:e[9]||(e[9]=o=>n(t).showUserInfoDialog=!1)},{default:a(()=>[Re]),_:1}),l(m,{size:"small",type:"primary",onClick:e[10]||(e[10]=o=>P())},{default:a(()=>[Le]),_:1})])]),_:1},8,["modelValue"]),l(x,{title:"\u914D\u7F6E\u7528\u6237\u89D2\u8272",modelValue:n(t).showRoleDialog,"onUpdate:modelValue":e[13]||(e[13]=o=>n(t).showRoleDialog=o),"close-on-click-modal":!1,close:E},{default:a(()=>[w("div",Be,[l(te,{tag:"div",class:"is-empty","wrap-class":"el-select-dropdown__wrap","view-class":"el-select-dropdown__list"},{default:a(()=>[l(ee,{ref:"roles",data:n(t).roleList,"show-checkbox":"","check-on-click-node":"","node-key":"id",onCheck:K},null,8,["data"])]),_:1})]),w("span",Se,[l(m,{size:"small",type:"primary",onClick:e[12]||(e[12]=o=>J())},{default:a(()=>[Ae]),_:1})])]),_:1},8,["modelValue"])]),l(oe,{title:"\u65B0\u589E\u7528\u6237",modelValue:n(t).drawer,"onUpdate:modelValue":e[14]||(e[14]=o=>n(t).drawer=o),"destroy-on-close":!0,"custom-class":"drawer",ref:"drawer","close-on-press-escape":!0,"before-close":G},{default:a(()=>[l(me)]),_:1},8,["modelValue"])])}}};export{je as default};
